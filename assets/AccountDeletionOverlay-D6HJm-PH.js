import{b as j,r as w,j as e,s as i}from"./index-CRZ081Ij.js";function v({isOpen:g,onClose:a}){const{user:s,signOut:h}=j(),[o,n]=w.useState(!1),x=async t=>{if(t.preventDefault(),!(!s||o)){n(!0);try{const{error:r}=await i.from("portfolio_items").delete().eq("user_id",s.id);if(r)throw new Error(`Portfolio deletion failed: ${r.message}`);const{error:l}=await i.from("saved_tattoos").delete().eq("user_id",s.id);if(l)throw new Error(`Saved tattoos deletion failed: ${l.message}`);const{error:c}=await i.from("followers").delete().or(`follower_id.eq.${s.id},following_id.eq.${s.id}`);if(c)throw new Error(`Followers deletion failed: ${c.message}`);const{error:d}=await i.from("messages").delete().or(`sender_id.eq.${s.id},receiver_id.eq.${s.id}`);if(d)throw new Error(`Messages deletion failed: ${d.message}`);const{error:m}=await i.from("artist_services").delete().eq("user_id",s.id);if(m)throw new Error(`Services deletion failed: ${m.message}`);const{error:u}=await i.from("bookings").delete().or(`client_id.eq.${s.id},artist_id.eq.${s.id}`);if(u)throw new Error(`Bookings deletion failed: ${u.message}`);const{error:f}=await i.from("profiles").delete().eq("user_id",s.id);if(f)throw new Error(`Profile deletion failed: ${f.message}`);await h()}catch(r){console.error("Error deleting account:",r),alert(`Errore durante l'eliminazione dell'account: ${r instanceof Error?r.message:"Errore sconosciuto"}`)}finally{n(!1)}}};return g?e.jsx("div",{className:"modal-overlay",onClick:t=>t.target===t.currentTarget&&a(),children:e.jsxs("div",{className:"modal-content confirmation-modal",children:[e.jsx("button",{className:"modal-close-btn",onClick:a,children:"×"}),e.jsxs("div",{className:"auth-content",children:[e.jsxs("div",{className:"header-card",children:[e.jsx("h2",{children:"Elimina Account"}),e.jsx("p",{children:"Sei sicuro di voler eliminare definitivamente il tuo account? Questa azione non può essere annullata."})]}),e.jsxs("form",{className:"auth-form",onSubmit:x,children:[e.jsxs("div",{className:"bio-suggestions",children:[e.jsx("p",{className:"suggestions-title",children:"⚠️ Attenzione:"}),e.jsxs("ul",{className:"suggestions-list",children:[e.jsx("li",{className:"suggestion-item",children:"Tutti i tuoi dati personali"}),e.jsx("li",{className:"suggestion-item",children:"Portfolio e immagini caricate"}),e.jsx("li",{className:"suggestion-item",children:"Messaggi e conversazioni"}),e.jsx("li",{className:"suggestion-item",children:"Prenotazioni e appuntamenti"}),e.jsx("li",{className:"suggestion-item",children:"Liste di tatuaggi salvati"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{type:"button",className:"action-btn",onClick:a,disabled:o,children:[e.jsx("span",{className:"action-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),e.jsx("span",{className:"action-text",children:"Annulla"})]}),e.jsxs("button",{type:"submit",className:"action-btn",disabled:o,children:[e.jsx("span",{className:"action-icon",children:e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[e.jsx("polyline",{points:"3,6 5,6 21,6"}),e.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"}),e.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),e.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})}),e.jsx("span",{className:"action-text",children:o?"Eliminando...":"Elimina"})]})]})]})]})]})}):null}export{v as AccountDeletionOverlay};
