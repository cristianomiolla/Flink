const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/EmailChangeOverlay-Cuz7pgN0.js","assets/index-CRZ081Ij.js","assets/index-BzcMdIz7.css","assets/FullNameChangeOverlay-DeUQ6isx.js","assets/PasswordChangeOverlay-B2t_QPZt.js","assets/AccountDeletionOverlay-D6HJm-PH.js"])))=>i.map(i=>d[i]);
import{b as w,a as _,r as s,j as e,S,_ as t,s as E}from"./index-CRZ081Ij.js";import{P as A}from"./PageHeader-3WudJlMU.js";const P=s.lazy(()=>t(()=>import("./EmailChangeOverlay-Cuz7pgN0.js"),__vite__mapDeps([0,1,2])).then(i=>({default:i.EmailChangeOverlay}))),I=s.lazy(()=>t(()=>import("./FullNameChangeOverlay-DeUQ6isx.js"),__vite__mapDeps([3,1,2])).then(i=>({default:i.FullNameChangeOverlay}))),T=s.lazy(()=>t(()=>import("./PasswordChangeOverlay-B2t_QPZt.js"),__vite__mapDeps([4,1,2])).then(i=>({default:i.PasswordChangeOverlay}))),z=s.lazy(()=>t(()=>import("./AccountDeletionOverlay-D6HJm-PH.js"),__vite__mapDeps([5,1,2])).then(i=>({default:i.AccountDeletionOverlay})));function R({onLogoClick:i}){const{profile:n,refreshProfile:r}=w(),c=_(),[d,m]=s.useState(!1),[h,u]=s.useState(!1),[x,p]=s.useState(!1),[f,a]=s.useState(!1),[g,j]=s.useState(!1),[o,v]=s.useState(!1);s.useEffect(()=>{window.scrollTo(0,0)},[]);const N=()=>{p(!0)},k=()=>{m(!0)},C=()=>{u(!0)},b=()=>{a(!0)},y=async()=>{if(!(!n||o)){v(!0);try{const{error:l}=await E.from("profiles").update({profile_type:"client",updated_at:new Date().toISOString()}).eq("user_id",n.user_id);if(l){alert("Errore durante il cambio del tipo di profilo. Riprova.");return}r&&await r(),a(!1),c("/")}catch{alert("Errore durante il cambio del tipo di profilo. Riprova.")}finally{v(!1)}}},O=()=>{j(!0)};return e.jsxs("div",{className:"settings-page",children:[e.jsx(S,{onLogoClick:i,hideOnMobile:!0}),e.jsxs("div",{className:"settings-mobile-header",children:[e.jsx("button",{className:"back-to-profile",onClick:()=>c("/profile-menu"),children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",children:e.jsx("polyline",{points:"15,18 9,12 15,6"})})}),e.jsx("div",{className:"settings-mobile-title",children:e.jsx("span",{className:"settings-title-text",children:"IMPOSTAZIONI"})}),e.jsx("div",{className:"settings-mobile-spacer"})]}),e.jsx("div",{className:"container",children:e.jsxs("div",{className:"settings-content",children:[e.jsx(A,{title:"IMPOSTAZIONI",subtitle:"Gestisci il tuo account e le preferenze",className:"settings-desktop-header"}),e.jsx("div",{className:"settings-card",children:e.jsxs("div",{className:"settings-links",children:[e.jsxs("button",{className:"settings-link",onClick:N,children:[e.jsxs("div",{className:"settings-link-content",children:[e.jsx("h3",{className:"settings-link-title",children:"Cambia Password"}),e.jsx("p",{className:"settings-link-description",children:"Aggiorna la password del tuo account"})]}),e.jsx("svg",{className:"settings-link-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("polyline",{points:"9,18 15,12 9,6"})})]}),e.jsxs("button",{className:"settings-link",onClick:k,children:[e.jsxs("div",{className:"settings-link-content",children:[e.jsx("h3",{className:"settings-link-title",children:"Cambia Email"}),e.jsx("p",{className:"settings-link-description",children:"Aggiorna l'indirizzo email del tuo account"})]}),e.jsx("svg",{className:"settings-link-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("polyline",{points:"9,18 15,12 9,6"})})]}),e.jsxs("button",{className:"settings-link",onClick:C,children:[e.jsxs("div",{className:"settings-link-content",children:[e.jsx("h3",{className:"settings-link-title",children:"Cambia Nome"}),e.jsx("p",{className:"settings-link-description",children:"Aggiorna il nome visualizzato sul tuo profilo"})]}),e.jsx("svg",{className:"settings-link-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("polyline",{points:"9,18 15,12 9,6"})})]}),n?.profile_type==="artist"&&e.jsxs("button",{className:"settings-link",onClick:b,children:[e.jsxs("div",{className:"settings-link-content",children:[e.jsx("h3",{className:"settings-link-title",children:"Cambia a Cliente"}),e.jsx("p",{className:"settings-link-description",children:"Attualmente sei: Artista"})]}),e.jsx("svg",{className:"settings-link-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("polyline",{points:"9,18 15,12 9,6"})})]}),e.jsxs("button",{className:"settings-link danger",onClick:O,children:[e.jsxs("div",{className:"settings-link-content",children:[e.jsx("h3",{className:"settings-link-title",children:"Elimina Account"}),e.jsx("p",{className:"settings-link-description",children:"Elimina definitivamente il tuo account"})]}),e.jsx("svg",{className:"settings-link-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("polyline",{points:"9,18 15,12 9,6"})})]})]})})]})}),x&&e.jsx(s.Suspense,{fallback:e.jsx("div",{}),children:e.jsx(T,{isOpen:x,onClose:()=>p(!1)})}),d&&e.jsx(s.Suspense,{fallback:e.jsx("div",{}),children:e.jsx(P,{isOpen:d,onClose:()=>m(!1)})}),h&&e.jsx(s.Suspense,{fallback:e.jsx("div",{}),children:e.jsx(I,{isOpen:h,onClose:()=>u(!1)})}),f&&e.jsx("div",{className:"modal-overlay",onClick:l=>l.target===l.currentTarget&&a(!1),children:e.jsxs("div",{className:"modal-content auth-modal",children:[e.jsx("div",{className:"auth-header-sticky",children:e.jsx("button",{className:"modal-close-btn",onClick:()=>a(!1),children:"×"})}),e.jsx("div",{className:"auth-modal-header"}),e.jsxs("div",{className:"auth-content",children:[e.jsxs("div",{className:"header-card",children:[e.jsx("h2",{children:"CAMBIA A CLIENTE"}),e.jsx("p",{children:"Stai per cambiare il tuo tipo di profilo da Artista a Cliente. Questo nasconderà le tue funzionalità da artista"})]}),e.jsxs("form",{className:"auth-form",onSubmit:l=>{l.preventDefault(),y()},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tipo attuale"}),e.jsx("div",{className:"current-email-display",children:"Artista"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Nuovo tipo profilo"}),e.jsx("div",{className:"current-email-display",children:"Cliente"})]}),e.jsxs("div",{className:"warning-message",style:{background:"#FEF3C7",color:"#92400E",padding:"1rem",borderRadius:"4px",fontSize:"0.875rem"},children:[e.jsx("strong",{children:"Attenzione:"})," Cambiando a Cliente perderai l'accesso alle funzionalità da artista come il portfolio personale e la gestione dei lavori. Potrai sempre tornare artista in futuro."]}),e.jsx("button",{type:"submit",className:"action-btn",disabled:o,children:o?"Cambiando...":"Cambia a Cliente"})]})]})]})}),g&&e.jsx(s.Suspense,{fallback:e.jsx("div",{}),children:e.jsx(z,{isOpen:g,onClose:()=>j(!1)})})]})}export{R as SettingsPage};
